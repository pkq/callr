<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Call R from R â€¢ callr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Call R from R">
<meta property="og:description" content="It is sometimes useful to perform a computation in a
    separate R process, without affecting the current R process at all.
    This packages does exactly that.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">callr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">3.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://www.tidyverse.org/blog/2019/09/callr-task-q">A multi process task queue in 100 lines of R code</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-lib/callr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="callr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#callr" class="anchor"></a>callr</h1></div>
<blockquote>
<p>Call R from R</p>
</blockquote>
<!-- badges: start -->
<p><a href="https://lifecycle.r-lib.org/articles/stages.html"><img src="https://lifecycle.r-lib.org/articles/figures/lifecycle-stable.svg" alt="lifecycle"></a> <a href="https://github.com/r-lib/callr/actions"><img src="https://github.com/r-lib/callr/workflows/R-CMD-check/badge.svg" alt="R build status"></a> <a href="https://www.r-pkg.org/pkg/callr"><img src="https://www.r-pkg.org/badges/version/callr"></a> <a href="https://www.r-pkg.org/pkg/callr"><img src="https://cranlogs.r-pkg.org/badges/callr" alt="CRAN RStudio mirror downloads"></a> <a href="https://codecov.io/github/r-lib/callr?branch=master"><img src="https://img.shields.io/codecov/c/github/r-lib/callr/master.svg" alt="Coverage Status"></a> <!-- badges: end --></p>
<p>It is sometimes useful to perform a computation in a separate R process, without affecting the current R process at all. This packages does exactly that.</p>
<hr>
<ul>
<li><a href="#features">Features</a></li>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#synchronous-one-off-r-processes">Synchronous, one-off R processes</a>
<ul>
<li><a href="#passing-arguments">Passing arguments</a></li>
<li><a href="#using-packages">Using packages</a></li>
<li><a href="#error-handling">Error handling</a></li>
<li><a href="#standard-output-and-error">Standard output and error</a></li>
</ul>
</li>
<li><a href="#background-r-processes">Background R processes</a></li>
<li><a href="#multiple-background-r-processes-and-poll">Multiple background R processes and <code>poll()</code></a></li>
<li><a href="#persistent-r-sessions">Persistent R sessions</a></li>
<li><a href="#running-r-cmd-commands">Running <code>R CMD</code> commands</a></li>
<li><a href="#license">License</a></li>
</ul>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h2>
<ul>
<li>Calls an R function, with arguments, in a subprocess.</li>
<li>Copies function arguments to the subprocess and copies the return value of the function back, seamlessly.</li>
<li>Copies error objects back from the subprocess, including a stack trace.</li>
<li>Shows and/or collects the standard output and standard error of the subprocess.</li>
<li>Supports both one-off and persistent R subprocesses.</li>
<li>Calls the function synchronously or asynchronously (in the background).</li>
<li>Can call <code>R CMD</code> commands, synchronously or asynchronously.</li>
<li>Can call R scripts, synchronously or asynchronously.</li>
<li>Provides extensible <code>r_process</code>, <code>rcmd_process</code> and <code>rscript_process</code> R6 classes, based on <code><a href="http://processx.r-lib.org/reference/process.html">processx::process</a></code>.</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"callr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="synchronous-one-off-r-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#synchronous-one-off-r-processes" class="anchor"></a>Synchronous, one-off R processes</h2>
<p>Use <code><a href="reference/r.html">r()</a></code> to run an R function in a new R process. The results are passed back seamlessly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://callr.r-lib.org">callr</a></span><span class="op">)</span>
<span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; Sepal.Length    0.6856935  -0.0424340    1.2743154   0.5162707</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; Sepal.Width    -0.0424340   0.1899794   -0.3296564  -0.1216394</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; Petal.Length    1.2743154  -0.3296564    3.1162779   1.2956094</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; Petal.Width     0.5162707  -0.1216394    1.2956094   0.5810063</span></span></code></pre></div>
<div id="passing-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#passing-arguments" class="anchor"></a>Passing arguments</h3>
<p>You can pass arguments to the function by setting <code>args</code> to the list of arguments. This is often necessary as these arguments are explicitly copied to the child process, whereas the evaluated function cannot refer to variables in the parent. For example, the following does not work:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mycars</span> <span class="op">&lt;-</span> <span class="va">cars</span>
<span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mycars</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#&gt; Error: callr subprocess failed: object 'mycars' not found</span></span></code></pre></div>
<p>But this does:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mycars</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#&gt;      speed           dist       </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt;  Min.   : 4.0   Min.   :  2.00  </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt;  1st Qu.:12.0   1st Qu.: 26.00  </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;  Median :15.0   Median : 36.00  </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt;  Mean   :15.4   Mean   : 42.98  </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;  3rd Qu.:19.0   3rd Qu.: 56.00  </span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;  Max.   :25.0   Max.   :120.00</span></span></code></pre></div>
<p>Note that the arguments will be serialized and saved to a file, so if they are large R objects, it might take a long time for the child process to start up.</p>
</div>
<div id="using-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#using-packages" class="anchor"></a>Using packages</h3>
<p>You can use any R package in the child process, just make sure to refer to it explicitly with the <code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code> operator. For example, the following code creates an <a href="https://github.com/igraph/rigraph">igraph</a> graph in the child, and calculates some metrics of it.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu">sample_gnp</span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>; <span class="fu">igraph</span><span class="fu">::</span><span class="fu">diameter</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#&gt; [1] 14</span></span></code></pre></div>
</div>
<div id="error-handling" class="section level3">
<h3 class="hasAnchor">
<a href="#error-handling" class="anchor"></a>Error handling</h3>
<p>callr copies errors from the child process back to the main R session:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fl">1</span> <span class="op">+</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#&gt; Error: callr subprocess failed: non-numeric argument to binary operator</span></span></code></pre></div>
<p>callr sets the <code>.Last.error</code> variable, and after an error you can inspect this for more details about the error, including stack traces both from the main R process and the subprocess.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.Last.error</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#&gt; &lt;callr_status_error: callr subprocess failed: non-numeric argument to binary operator&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; --&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; &lt;callr_remote_error in 1 + "A":</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt;  non-numeric argument to binary operator&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt;  in process 32341</span></span></code></pre></div>
<p>The error objects has two parts. The first belongs to the main process, and the second belongs to the subprocess.</p>
<p><code>.Last.error</code> also includes a stack trace, that includes both the main R process and the subprocess:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.Last.error.trace</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#&gt;  Stack trace:</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt; </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt;  Process 32229:</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt;  36. callr:::r(function() 1 + "A")</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt;  37. callr:::get_result(output = out, options)</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt;  38. throw(newerr, parent = remerr[[2]])</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt;  x callr subprocess failed: non-numeric argument to binary operator </span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; </span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt;  Process 32341:</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt;  50. (function ()  ...</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt;  51. base:::.handleSimpleError(function (e)  ...</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt;  52. h(simpleError(msg, call))</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt;  x non-numeric argument to binary operator</span></span></code></pre></div>
<p>The top part of the trace contains the frames in the main process, and the bottom part contains the frames in the subprocess, starting with the anonymous function.</p>
</div>
<div id="standard-output-and-error" class="section level3">
<h3 class="hasAnchor">
<a href="#standard-output-and-error" class="anchor"></a>Standard output and error</h3>
<p>By default, the standard output and error of the child is lost, but you can request callr to redirect them to files, and then inspect the files in the parent:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r.html">r</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"hello world!"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"hello again!"</span><span class="op">)</span> <span class="op">}</span>,
  stdout <span class="op">=</span> <span class="st">"/tmp/out"</span>, stderr <span class="op">=</span> <span class="st">"/tmp/err"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="st">"/tmp/out"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#&gt; [1] "[1] \"hello world!\""</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="st">"/tmp/err"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#&gt; [1] "hello again!"</span></span></code></pre></div>
<p>With the <code>stdout</code> option, the standard output is collected and can be examined once the child process finished. The <code>show = TRUE</code> options will also show the output of the child, as it is printed, on the console of the parent.</p>
</div>
</div>
<div id="background-r-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#background-r-processes" class="anchor"></a>Background R processes</h2>
<p><code><a href="reference/r_bg.html">r_bg()</a></code> is similar to <code><a href="reference/r.html">r()</a></code> but it starts the R process in the background. It returns an <code>r_process</code> R6 object, that provides a rich API:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r_bg.html">r_bg</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">.2</span><span class="op">)</span><span class="op">)</span>
<span class="va">rp</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#&gt; PROCESS 'R', running, pid 32379.</span></span></code></pre></div>
<p>This is a list of all <code>r_process</code> methods:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="va">rp</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#&gt;  [1] "as_ps_handle"          "clone"                 "finalize"             </span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt;  [4] "format"                "get_cmdline"           "get_cpu_times"        </span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt;  [7] "get_error_connection"  "get_error_file"        "get_exe"              </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; [10] "get_exit_status"       "get_input_connection"  "get_input_file"       </span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; [13] "get_memory_info"       "get_name"              "get_output_connection"</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt; [16] "get_output_file"       "get_pid"               "get_poll_connection"  </span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; [19] "get_result"            "get_start_time"        "get_status"           </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">#&gt; [22] "get_username"          "get_wd"                "has_error_connection" </span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt; [25] "has_input_connection"  "has_output_connection" "has_poll_connection"  </span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; [28] "initialize"            "interrupt"             "is_alive"             </span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt; [31] "is_incomplete_error"   "is_incomplete_output"  "is_supervised"        </span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#&gt; [34] "kill"                  "kill_tree"             "poll_io"              </span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">#&gt; [37] "print"                 "read_all_error"        "read_all_error_lines" </span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">#&gt; [40] "read_all_output"       "read_all_output_lines" "read_error"           </span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co">#&gt; [43] "read_error_lines"      "read_output"           "read_output_lines"    </span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#&gt; [46] "resume"                "signal"                "supervise"            </span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#&gt; [49] "suspend"               "wait"                  "write_input"</span></span></code></pre></div>
<p>These include all methods of the <code><a href="http://processx.r-lib.org/reference/process.html">processx::process</a></code> superclass and the new <code><a href="reference/get_result.html">get_result()</a></code> method, to retrieve the R object returned by the function call. Some of the handiest methods are:</p>
<ul>
<li>
<code>get_exit_status()</code> to query the exit status of a finished process.</li>
<li>
<code><a href="reference/get_result.html">get_result()</a></code> to collect the return value of the R function call.</li>
<li>
<code>interrupt()</code> to send an interrupt to the process. This is equivalent to a <code>CTRL+C</code> key press, and the R process might ignore it.</li>
<li>
<code>is_alive()</code> to check if the process is alive.</li>
<li>
<code>kill()</code> to terminate the process.</li>
<li>
<code>poll_io()</code> to wait for any standard output, standard error, or the completion of the process, with a timeout.</li>
<li>
<code>read_*()</code> to read the standard output or error.</li>
<li>
<code>suspend()</code> and <code>resume()</code> to stop and continue a process.</li>
<li>
<code>wait()</code> to wait for the completion of the process, with a timeout.</li>
</ul>
</div>
<div id="multiple-background-r-processes-and-poll" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-background-r-processes-and-poll" class="anchor"></a>Multiple background R processes and <code>poll()</code>
</h2>
<p>Multiple background R processes are best managed with the <code><a href="http://processx.r-lib.org/reference/poll.html">processx::poll()</a></code> function that waits for events (standard output/error or termination) from multiple processes. It returns as soon as one process has generated an event, or if its timeout has expired. The timeout is in milliseconds.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r_bg.html">r_bg</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>; <span class="st">"1 done"</span> <span class="op">}</span><span class="op">)</span>
<span class="va">rp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r_bg.html">r_bg</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>; <span class="st">"2 done"</span> <span class="op">}</span><span class="op">)</span>
<span class="fu">processx</span><span class="fu">::</span><span class="fu"><a href="http://processx.r-lib.org/reference/poll.html">poll</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">rp1</span>, <span class="va">rp2</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#&gt;   output    error  process </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">#&gt; "silent" "silent" "silent" </span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#&gt; </span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co">#&gt;   output    error  process </span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co">#&gt; "silent" "silent"  "ready"</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rp2</span><span class="op">$</span><span class="fu">get_result</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#&gt; [1] "2 done"</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">processx</span><span class="fu">::</span><span class="fu"><a href="http://processx.r-lib.org/reference/poll.html">poll</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">rp1</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt;   output    error  process </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt; "silent" "silent"  "ready"</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rp1</span><span class="op">$</span><span class="fu">get_result</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">#&gt; [1] "1 done"</span></span></code></pre></div>
</div>
<div id="persistent-r-sessions" class="section level2">
<h2 class="hasAnchor">
<a href="#persistent-r-sessions" class="anchor"></a>Persistent R sessions</h2>
<p><code>r_session</code> is another <code><a href="http://processx.r-lib.org/reference/process.html">processx::process</a></code> subclass that represents a persistent background R session:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/r_session.html">r_session</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="va">rs</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#&gt; R SESSION, alive, idle, pid 32412.</span></span></code></pre></div>
<p><code>r_session$run()</code> is a synchronous call, that works similarly to <code><a href="reference/r.html">r()</a></code>, but uses the persistent session. <code>r_session$call()</code> starts the function call and returns immediately. The <code>r_session$poll_process()</code> method or <code><a href="http://processx.r-lib.org/reference/poll.html">processx::poll()</a></code> can then be used to wait for the completion or other events from one or more R sessions, R processes or other <code><a href="http://processx.r-lib.org/reference/process.html">processx::process</a></code> objects.</p>
<p>Once an R session is done with an asynchronous computation, its <code>poll_process()</code> method returns <code>"ready"</code> and the <code>r_session$read()</code> method can read out the result.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">#&gt;  [1] 0.75342837 0.12946532 0.98800304 0.09682751 0.23944882 0.99726443</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="co">#&gt;  [7] 0.91098802 0.61136112 0.51781725 0.53566166</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs</span><span class="op">$</span><span class="fu">call</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">rs</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">#&gt; R SESSION, alive, busy, pid 32412.</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs</span><span class="op">$</span><span class="fu">poll_process</span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">#&gt; [1] "ready"</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs</span><span class="op">$</span><span class="fu">read</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">#&gt; $code</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#&gt; [1] 200</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#&gt; </span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co">#&gt; $message</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co">#&gt; [1] "done callr-rs-result-7de57e80bd54"</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co">#&gt; </span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co">#&gt; $result</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co">#&gt;  [1]  0.73848421 -0.07600563 -1.18598532  0.10692265 -0.11717386 -0.24769265</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co">#&gt;  [7] -0.13800969 -0.97854700 -0.30949881 -1.57689514</span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="co">#&gt; </span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="co">#&gt; $stdout</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="co">#&gt; [1] ""</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co">#&gt; </span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="co">#&gt; $stderr</span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="co">#&gt; [1] ""</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="co">#&gt; </span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="co">#&gt; $error</span></span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="co">#&gt; NULL</span></span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="co">#&gt; </span></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="co">#&gt; [1] "callr_session_result"</span></span></code></pre></div>
</div>
<div id="running-r-cmd-commands" class="section level2">
<h2 class="hasAnchor">
<a href="#running-r-cmd-commands" class="anchor"></a>Running <code>R CMD</code> commands</h2>
<p>The <code><a href="reference/rcmd.html">rcmd()</a></code> function calls an <code>R CMD</code> command. For example, you can call <code>R CMD INSTALL</code>, <code>R CMD check</code> or <code>R CMD config</code> this way:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/rcmd.html">rcmd</a></span><span class="op">(</span><span class="st">"config"</span>, <span class="st">"CC"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">#&gt; $status</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co">#&gt; </span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co">#&gt; $stdout</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co">#&gt; [1] "clang -mmacosx-version-min=10.13\n"</span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="co">#&gt; </span></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">#&gt; $stderr</span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">#&gt; [1] ""</span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#&gt; </span></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">#&gt; $timeout</span></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="co">#&gt; </span></span>
<span id="cb43-13"><a href="#cb43-13"></a><span class="co">#&gt; $command</span></span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="co">#&gt; [1] "/Library/Frameworks/R.framework/Versions/4.0/Resources/bin/R"</span></span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="co">#&gt; [2] "CMD"                                                         </span></span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="co">#&gt; [3] "config"                                                      </span></span>
<span id="cb43-17"><a href="#cb43-17"></a><span class="co">#&gt; [4] "CC"</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#&gt;$stdout</span>
<span class="co">#&gt;[1] "clang\n"</span>
<span class="co">#&gt;</span>
<span class="co">#&gt;$stderr</span>
<span class="co">#&gt;[1] ""</span>
<span class="co">#&gt;</span>
<span class="co">#&gt;$status</span>
<span class="co">#&gt;[1] 0</span></code></pre></div>
<p>This returns a list with three components: the standard output, the standard error, and the exit (status) code of the <code>R CMD</code> command.</p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>MIT Â© Mango Solutions, RStudio</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=callr">https://â€‹cloud.r-project.org/â€‹package=callr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/r-lib/callr/">https://â€‹github.com/â€‹r-lib/â€‹callr/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/r-lib/callr/issues">https://â€‹github.com/â€‹r-lib/â€‹callr/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/gaborcsardi">GÃ¡bor CsÃ¡rdi</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-7098-9676" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://github.com/wch">Winston Chang</a> <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a> <br><small class="roles"> Copyright holder, funder </small>  </li>
<li>Mango Solutions <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/gaborcsardi">GÃ¡bor CsÃ¡rdi</a>, <a href="https://github.com/wch">Winston Chang</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>, Mango Solutions.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
